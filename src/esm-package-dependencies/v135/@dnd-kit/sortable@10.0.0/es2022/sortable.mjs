/* esm.sh - esbuild bundle(@dnd-kit/sortable@10.0.0) es2022 production */
import q,{useMemo as k,useRef as Y,useEffect as X,useState as pe,useContext as be}from"react";import{useDndContext as ve,getClientRect as he,useDroppable as xe,useDraggable as Ie,closestCorners as me,getFirstCollision as we,getScrollableAncestors as ye,KeyboardCode as m}from"../../core@6.3.0/es2022/core.mjs";import{useUniqueId as Re,useIsomorphicLayoutEffect as B,CSS as H,useCombinedRefs as Se,isKeyboardEvent as Ce,subtract as De}from"../../utilities@3.2.2/es2022/utilities.mjs";function V(e,t,r){let n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function je(e,t,r){let n=e.slice();return n[t]=e[r],n[r]=e[t],n}function Ae(e,t){return e.reduce((r,n,o)=>{let s=t.get(n);return s&&(r[o]=s),r},Array(e.length))}function O(e){return e!==null&&e>=0}function Te(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Ne(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}var E={scaleX:1,scaleY:1},qe=e=>{var t;let{rects:r,activeNodeRect:n,activeIndex:o,overIndex:s,index:i}=e,a=(t=r[o])!=null?t:n;if(!a)return null;let d=Oe(r,i,o);if(i===o){let c=r[s];return c?{x:o<s?c.left+c.width-(a.left+a.width):c.left-a.left,y:0,...E}:null}return i>o&&i<=s?{x:-a.width-d,y:0,...E}:i<o&&i>=s?{x:a.width+d,y:0,...E}:{x:0,y:0,...E}};function Oe(e,t,r){let n=e[t],o=e[t-1],s=e[t+1];return!n||!o&&!s?0:r<t?o?n.left-(o.left+o.width):s.left-(n.left+n.width):s?s.left-(n.left+n.width):n.left-(o.left+o.width)}var J=e=>{let{rects:t,activeIndex:r,overIndex:n,index:o}=e,s=V(t,n,r),i=t[o],a=s[o];return!a||!i?null:{x:a.left-i.left,y:a.top-i.top,scaleX:a.width/i.width,scaleY:a.height/i.height}},Be=e=>{let{activeIndex:t,index:r,rects:n,overIndex:o}=e,s,i;return r===t&&(s=n[r],i=n[o]),r===o&&(s=n[r],i=n[t]),!i||!s?null:{x:i.left-s.left,y:i.top-s.top,scaleX:i.width/s.width,scaleY:i.height/s.height}},L={scaleX:1,scaleY:1},He=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:o,rects:s,overIndex:i}=e,a=(t=s[r])!=null?t:n;if(!a)return null;if(o===r){let c=s[i];return c?{x:0,y:r<i?c.top+c.height-(a.top+a.height):c.top-a.top,...L}:null}let d=Ee(s,o,r);return o>r&&o<=i?{x:0,y:-a.height-d,...L}:o<r&&o>=i?{x:0,y:a.height+d,...L}:{x:0,y:0,...L}};function Ee(e,t,r){let n=e[t],o=e[t-1],s=e[t+1];return n?r<t?o?n.top-(o.top+o.height):s?s.top-(n.top+n.height):0:s?s.top-(n.top+n.height):o?n.top-(o.top+o.height):0:0}var Q="Sortable",W=q.createContext({activeIndex:-1,containerId:Q,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:J,disabled:{draggable:!1,droppable:!1}});function Ve(e){let{children:t,id:r,items:n,strategy:o=J,disabled:s=!1}=e,{active:i,dragOverlay:a,droppableRects:d,over:c,measureDroppableContainers:l}=ve(),u=Re(Q,r),f=a.rect!==null,g=k(()=>n.map(I=>typeof I=="object"&&"id"in I?I.id:I),[n]),w=i!=null,y=i?g.indexOf(i.id):-1,v=c?g.indexOf(c.id):-1,R=Y(g),x=!Te(g,R.current),h=v!==-1&&y===-1||x,b=Ne(s);B(()=>{x&&w&&l(g)},[x,g,w,l]),X(()=>{R.current=g},[g]);let S=k(()=>({activeIndex:y,containerId:u,disabled:b,disableTransforms:h,items:g,overIndex:v,useDragOverlay:f,sortedRects:Ae(g,d),strategy:o}),[y,u,b.draggable,b.droppable,h,g,v,d,f,o]);return q.createElement(W.Provider,{value:S},t)}var Le=e=>{let{id:t,items:r,activeIndex:n,overIndex:o}=e;return V(r,n,o).indexOf(t)},ke=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:o,items:s,newIndex:i,previousItems:a,previousContainerId:d,transition:c}=e;return!c||!n||a!==s&&o===i?!1:r?!0:i!==o&&t===d},Xe={duration:200,easing:"ease"},Z="transform",$e=H.Transition.toString({property:Z,duration:0,easing:"linear"}),ze={roleDescription:"sortable"};function Ge(e){let{disabled:t,index:r,node:n,rect:o}=e,[s,i]=pe(null),a=Y(r);return B(()=>{if(!t&&r!==a.current&&n.current){let d=o.current;if(d){let c=he(n.current,{ignoreTransform:!0}),l={x:d.left-c.left,y:d.top-c.top,scaleX:d.width/c.width,scaleY:d.height/c.height};(l.x||l.y)&&i(l)}}r!==a.current&&(a.current=r)},[t,r,n,o]),X(()=>{s&&i(null)},[s]),s}function Je(e){let{animateLayoutChanges:t=ke,attributes:r,disabled:n,data:o,getNewIndex:s=Le,id:i,strategy:a,resizeObserverConfig:d,transition:c=Xe}=e,{items:l,containerId:u,activeIndex:f,disabled:g,disableTransforms:w,sortedRects:y,overIndex:v,useDragOverlay:R,strategy:x}=be(W),h=Ye(n,g),b=l.indexOf(i),S=k(()=>({sortable:{containerId:u,index:b,items:l},...o}),[u,o,b,l]),I=k(()=>l.slice(l.indexOf(i)),[l,i]),{rect:N,node:_,isOver:te,setNodeRef:P}=xe({id:i,data:S,disabled:h.droppable,resizeObserverConfig:{updateMeasurementsFor:I,...d}}),{active:A,activatorEvent:ne,activeNodeRect:re,attributes:oe,setNodeRef:F,listeners:ie,isDragging:z,over:se,setActivatorNodeRef:ae,transform:ce}=Ie({id:i,data:S,attributes:{...ze,...r},disabled:h.draggable}),le=Se(P,F),C=!!A,K=C&&!w&&O(f)&&O(v),M=!R&&z,U=M&&K?ce:null,de=K?U??(a??x)({rects:y,activeNodeRect:re,activeIndex:f,overIndex:v,index:b}):null,T=O(f)&&O(v)?s({id:i,items:l,activeIndex:f,overIndex:v}):b,D=A?.id,p=Y({activeId:D,items:l,newIndex:T,containerId:u}),ue=l!==p.current.items,j=t({active:A,containerId:u,isDragging:z,isSorting:C,id:i,index:b,items:l,newIndex:p.current.newIndex,previousItems:p.current.items,previousContainerId:p.current.containerId,transition:c,wasDragging:p.current.activeId!=null}),G=Ge({disabled:!j,index:b,node:_,rect:N});return X(()=>{C&&p.current.newIndex!==T&&(p.current.newIndex=T),u!==p.current.containerId&&(p.current.containerId=u),l!==p.current.items&&(p.current.items=l)},[C,T,u,l]),X(()=>{if(D===p.current.activeId)return;if(D!=null&&p.current.activeId==null){p.current.activeId=D;return}let ge=setTimeout(()=>{p.current.activeId=D},50);return()=>clearTimeout(ge)},[D]),{active:A,activeIndex:f,attributes:oe,data:S,rect:N,index:b,newIndex:T,items:l,isOver:te,isSorting:C,isDragging:z,listeners:ie,node:_,overIndex:v,over:se,setNodeRef:le,setActivatorNodeRef:ae,setDroppableNodeRef:P,setDraggableNodeRef:F,transform:G??de,transition:fe()};function fe(){if(G||ue&&p.current.newIndex===b)return $e;if(!(M&&!Ce(ne)||!c)&&(C||j))return H.Transition.toString({...c,property:Z})}}function Ye(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e?.draggable)!=null?r:t.draggable,droppable:(n=e?.droppable)!=null?n:t.droppable}}function $(e){if(!e)return!1;let t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}var _e=[m.Down,m.Right,m.Up,m.Left],Qe=(e,t)=>{let{context:{active:r,collisionRect:n,droppableRects:o,droppableContainers:s,over:i,scrollableAncestors:a}}=t;if(_e.includes(e.code)){if(e.preventDefault(),!r||!n)return;let d=[];s.getEnabled().forEach(u=>{if(!u||u!=null&&u.disabled)return;let f=o.get(u.id);if(f)switch(e.code){case m.Down:n.top<f.top&&d.push(u);break;case m.Up:n.top>f.top&&d.push(u);break;case m.Left:n.left>f.left&&d.push(u);break;case m.Right:n.left<f.left&&d.push(u);break}});let c=me({active:r,collisionRect:n,droppableRects:o,droppableContainers:d,pointerCoordinates:null}),l=we(c,"id");if(l===i?.id&&c.length>1&&(l=c[1].id),l!=null){let u=s.get(r.id),f=s.get(l),g=f?o.get(f.id):null,w=f?.node.current;if(w&&g&&u&&f){let v=ye(w).some((I,N)=>a[N]!==I),R=ee(u,f),x=Pe(u,f),h=v||!R?{x:0,y:0}:{x:x?n.width-g.width:0,y:x?n.height-g.height:0},b={x:g.left,y:g.top};return h.x&&h.y?b:De(b,h)}}}};function ee(e,t){return!$(e)||!$(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Pe(e,t){return!$(e)||!$(t)||!ee(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}export{Ve as SortableContext,V as arrayMove,je as arraySwap,ke as defaultAnimateLayoutChanges,Le as defaultNewIndexGetter,$ as hasSortableData,qe as horizontalListSortingStrategy,J as rectSortingStrategy,Be as rectSwappingStrategy,Qe as sortableKeyboardCoordinates,Je as useSortable,He as verticalListSortingStrategy};
//# sourceMappingURL=sortable.mjs.map